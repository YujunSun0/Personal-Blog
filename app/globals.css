@import "tailwindcss";

:root {
  /* 기본 배경/텍스트 */
  --background: #ffffff;
  --foreground: #171717;

  /* 컬러 시스템 - Primary */
  --color-primary: #3B82F6;
  --color-primary-hover: #2563EB;
  --color-primary-light: #DBEAFE;

  /* 컬러 시스템 - Secondary */
  --color-secondary: #10B981;
  --color-secondary-hover: #059669;

  /* 컬러 시스템 - 텍스트 */
  --color-text-primary: #171717;
  --color-text-secondary: #525252;
  --color-text-tertiary: #A3A3A3;

  /* 컬러 시스템 - 배경 */
  --color-bg-primary: #FFFFFF;
  --color-bg-secondary: #F9FAFB;
  --color-bg-tertiary: #F3F4F6;

  /* 컬러 시스템 - 테두리 */
  --color-border: #E5E7EB;
  --color-border-hover: #D1D5DB;

  /* 컬러 시스템 - 상태 */
  --color-success: #10B981;
  --color-success-bg: #D1FAE5;
  --color-warning: #F59E0B;
  --color-warning-bg: #FEF3C7;
  --color-error: #EF4444;
  --color-error-bg: #FEE2E2;
  --color-info: #3B82F6;
  --color-info-bg: #DBEAFE;

  /* 컬러 시스템 - 글 타입별 */
  --color-type-tech: #3B82F6;
  --color-type-tech-bg: #DBEAFE;
  --color-type-trouble: #F59E0B;
  --color-type-trouble-bg: #FEF3C7;
  --color-type-life: #10B981; /* PROJECT 타입용 */
  --color-type-life-bg: #D1FAE5; /* PROJECT 타입용 */

  /* 컨테이너 */
  --container-max-width: 1400px;
  --container-max-width-narrow: 768px; /* 게시글 상세 페이지용 */
  --container-padding-x: 2rem;
  /* 목차 너비 */
  --toc-width: 320px; /* w-80 = 20rem = 320px */
  /* 목차와 게시글 사이 gap (gap-8 = 2rem = 32px) */
  --toc-gap: 32px;
  /* 목차 margin-left: 1400px에서 (목차 너비 + gap)만큼, 1024px에서 0px로 점진적 감소 */
  /* gap을 빼서 실제 간격이 목차 너비와 일치하도록 */
  --toc-margin-left: clamp(0px, calc((100vw - 1024px) / (1400px - 1024px) * var(--toc-width) - var(--toc-gap)), calc(var(--toc-width) - var(--toc-gap)));
}

@media (max-width: 1400px) {
  :root {
    --container-padding-x: 1.5rem;
  }
}

@media (max-width: 1024px) {
  :root {
    --toc-margin-left: 0px;
  }
}

@media (max-width: 768px) {
  :root {
    --container-padding-x: 1rem;
  }
}

/* 다크모드 CSS 변수 */
.dark {
  /* 기본 배경/텍스트 */
  --background: #0a0a0a;
  --foreground: #ededed;

  /* 컬러 시스템 - Primary (다크모드에서도 동일하게 유지) */
  --color-primary: #3B82F6;
  --color-primary-hover: #60A5FA;
  --color-primary-light: #1E3A8A;

  /* 컬러 시스템 - Secondary */
  --color-secondary: #10B981;
  --color-secondary-hover: #34D399;

  /* 컬러 시스템 - 텍스트 */
  --color-text-primary: #F9FAFB;
  --color-text-secondary: #D1D5DB;
  --color-text-tertiary: #9CA3AF;

  /* 컬러 시스템 - 배경 */
  --color-bg-primary: #111827;
  --color-bg-secondary: #1F2937;
  --color-bg-tertiary: #374151;

  /* 컬러 시스템 - 테두리 */
  --color-border: #374151;
  --color-border-hover: #4B5563;

  /* 컬러 시스템 - 상태 */
  --color-success: #10B981;
  --color-success-bg: #064E3B;
  --color-warning: #F59E0B;
  --color-warning-bg: #78350F;
  --color-error: #EF4444;
  --color-error-bg: #7F1D1D;
  --color-info: #3B82F6;
  --color-info-bg: #1E3A8A;

  /* 컬러 시스템 - 글 타입별 */
  --color-type-tech: #60A5FA;
  --color-type-tech-bg: #1E3A8A;
  --color-type-trouble: #FBBF24;
  --color-type-trouble-bg: #78350F;
  --color-type-life: #34D399;
  --color-type-life-bg: #064E3B;
}

/* 다크모드 전환 애니메이션 */
html {
  transition: background-color 0.5s ease, color 0.5s ease;
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR',
    'Malgun Gothic', 'Apple SD Gothic Neo', Roboto, 'Helvetica Neue', Arial,
    sans-serif;
  line-height: 1.6;
  transition: background-color 0.5s ease, color 0.5s ease;
  /* 텍스트 줄바꿈: 기본적으로 keep-all 적용 */
  word-break: keep-all;
  overflow-wrap: break-word;
}

/* 모든 요소의 색상 전환 부드럽게 */
* {
  transition: background-color 0.5s ease, 
              color 0.5s ease, 
              border-color 0.5s ease,
              fill 0.5s ease,
              stroke 0.5s ease;
}

/* 텍스트 줄바꿈: 모든 텍스트 요소에 적용 */
/* 상속되지 않는 요소들 명시적 적용 */
button,
input,
textarea,
select,
a,
label,
span,
div {
  word-break: keep-all;
  overflow-wrap: break-word;
}

/* 제목 요소들 */
h1,
h2,
h3,
h4,
h5,
h6 {
  word-break: keep-all;
  overflow-wrap: break-word;
}

/* 리스트, 테이블 요소 */
li,
td,
th,
dd,
dt {
  word-break: keep-all;
  overflow-wrap: break-word;
}

/* 예외: 코드 관련 요소는 일반 줄바꿈 사용 */
code:not(pre code),
pre,
kbd,
samp,
.hljs,
.highlight {
  word-break: normal;
  overflow-wrap: normal;
}

/* 예외: 특정 UI 요소에서 줄바꿈 방지 (필요시 사용) */
.text-nowrap,
.nowrap {
  word-break: normal;
  overflow-wrap: normal;
  white-space: nowrap;
}

/* 이미지와 비디오는 제외 (성능 최적화) */
img,
video,
svg,
canvas,
iframe {
  transition: none;
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
  
  .container-width {
    max-width: var(--container-max-width);
  }
  
  .container-width-narrow {
    max-width: var(--container-max-width-narrow);
  }
  
  .container-padding-x {
    padding-left: var(--container-padding-x);
    padding-right: var(--container-padding-x);
  }
}

/* Markdown 콘텐츠 스타일 */
.markdown-content {
  @apply text-[var(--color-text-primary)];
}

.markdown-content blockquote {
  @apply whitespace-pre-line;
}

.markdown-content blockquote p {
  @apply mb-1;
}

.markdown-content blockquote p:last-child {
  @apply mb-0;
}

/* 리스트 스타일 개선 */
.markdown-content ul,
.markdown-content ol {
  margin-left: 1.5rem;
  margin-bottom: 1rem;
}

.markdown-content li {
  margin-bottom: 0.25rem;
  line-height: 1.6;
}

/* 중첩 리스트 스타일 */
.markdown-content li > ul,
.markdown-content li > ol {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
}

/* 리스트 안의 코드 블록 */
.markdown-content li > pre {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
}

/* 리스트 안의 문단 */
.markdown-content li > p {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
}

.markdown-content li > p:first-child {
  margin-top: 0;
}

.markdown-content li > p:last-child {
  margin-bottom: 0;
}

.markdown-content pre {
  @apply bg-[var(--color-bg-secondary)] rounded-lg p-4 overflow-x-auto my-4;
  white-space: pre;
}

.markdown-content pre code {
  @apply bg-transparent p-0;
  color: inherit;
  white-space: pre;
  display: block;
}

.markdown-content code {
  @apply bg-[var(--color-bg-secondary)] px-1.5 py-0.5 rounded text-sm font-mono;
  display: inline;
}

/* 인라인 코드는 인라인으로 표시 */
.markdown-content p code,
.markdown-content li code,
.markdown-content td code,
.markdown-content th code {
  display: inline;
  vertical-align: baseline;
}

/* 코드 블록 내부의 리스트나 다른 요소가 파싱되지 않도록 */
.markdown-content pre code * {
  display: inline;
  margin: 0;
  padding: 0;
  list-style: none;
}

/* Highlight.js 코드 블록 스타일 조정 */
.markdown-content .hljs {
  @apply bg-[var(--color-bg-secondary)] rounded-lg p-4;
  color: var(--color-text-primary);
}

.markdown-content .hljs-comment,
.markdown-content .hljs-quote {
  color: var(--color-text-tertiary);
}

.markdown-content .hljs-keyword,
.markdown-content .hljs-selector-tag,
.markdown-content .hljs-subst {
  color: #3b82f6;
}

.markdown-content .hljs-number,
.markdown-content .hljs-literal,
.markdown-content .hljs-variable,
.markdown-content .hljs-template-variable,
.markdown-content .hljs-tag .hljs-attr {
  color: #10b981;
}

.markdown-content .hljs-string,
.markdown-content .hljs-doctag {
  color: #f59e0b;
}

.markdown-content .hljs-title,
.markdown-content .hljs-section,
.markdown-content .hljs-selector-id {
  color: #ef4444;
}

.markdown-content .hljs-type,
.markdown-content .hljs-class .hljs-title {
  color: #8b5cf6;
}

.markdown-content .hljs-tag,
.markdown-content .hljs-name,
.markdown-content .hljs-attribute {
  color: #3b82f6;
}

.markdown-content .hljs-regexp,
.markdown-content .hljs-link {
  color: #10b981;
}

.markdown-content .hljs-symbol,
.markdown-content .hljs-bullet {
  color: #f59e0b;
}

.markdown-content .hljs-built_in,
.markdown-content .hljs-builtin-name {
  color: #8b5cf6;
}

.markdown-content .hljs-meta {
  color: var(--color-text-tertiary);
}

.markdown-content .hljs-deletion {
  background: #fee2e2;
}

.markdown-content .hljs-addition {
  background: #d1fae5;
}

.markdown-content .hljs-emphasis {
  font-style: italic;
}

.markdown-content .hljs-strong {
  font-weight: bold;
}

button {
  cursor: pointer;
  outline: none !important;
  -webkit-tap-highlight-color: transparent;
  -webkit-focus-ring-color: transparent;
}

button:focus {
  outline: none !important;
}

button:focus-visible {
  outline: none !important;
}

button:active {
  outline: none !important;
}

/* 클릭 가능한 요소들의 기본 outline 제거 */
a:focus,
button:focus,
[role="button"]:focus,
[role="tab"]:focus,
[role="option"]:focus {
  outline: none !important;
}

a:focus-visible,
button:focus-visible,
[role="button"]:focus-visible,
[role="tab"]:focus-visible,
[role="option"]:focus-visible {
  outline: none !important;
}

a:active,
button:active,
[role="button"]:active,
[role="tab"]:active,
[role="option"]:active {
  outline: none !important;
  -webkit-tap-highlight-color: transparent;
}

/* 모든 클릭 가능한 요소의 기본 하이라이트 제거 */
* {
  -webkit-tap-highlight-color: transparent;
}

*:focus {
  outline: none !important;
}

*:active {
  outline: none !important;
}

/* 애니메이션 */
@keyframes slide-up {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slide-down {
  from {
    transform: translateY(0);
    opacity: 1;
  }
  to {
    transform: translateY(100%);
    opacity: 0;
  }
}

.animate-slide-up {
  animation: slide-up 0.3s ease-out;
}

.animate-slide-down {
  animation: slide-down 0.3s ease-in;
}

/* 접근성 개선: 키보드 포커스만 스타일 적용 (마우스 클릭 제외) */
*:focus-visible:not(:active) {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* 스킵 링크 (키보드 사용자를 위한) */
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--color-primary);
  color: white;
  padding: 8px 16px;
  text-decoration: none;
  z-index: 100;
}

.skip-link:focus {
  top: 0;
}

/* 전역 커스텀 스크롤바 스타일 */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--color-border) transparent;
}

*::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

*::-webkit-scrollbar-track {
  background: transparent;
}

*::-webkit-scrollbar-thumb {
  background-color: var(--color-border);
  border-radius: 3px;
}

*::-webkit-scrollbar-thumb:hover {
  background-color: var(--color-border-hover);
}

/* 다크모드 토글 버튼 애니메이션 */
.theme-toggle-button {
  position: relative;
}

.theme-icon {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 1.25rem;
  height: 1.25rem;
  transition: transform 0.6s ease-in-out;
  transform-origin: 50% 200%;
}

.sun-icon {
  display: flex;
  opacity: 1;
  visibility: visible;
  transform: rotate(360deg);
}

.moon-icon {
  display: flex;
  opacity: 0;
  visibility: hidden;
  transform: rotate(0deg);
}

/* 라이트 모드에서 다크 모드로 전환 시 */
.theme-toggle-button.animating.from-light .sun-icon {
  visibility: visible;
  animation: sun-set 0.8s ease-in-out forwards;
}

.theme-toggle-button.animating.from-light .moon-icon {
  visibility: visible;
  animation: moon-rise 0.8s ease-in-out forwards;
}

/* 다크모드일 때 */
.dark .sun-icon {
  display: flex;
  opacity: 0;
  visibility: hidden;
  transform: rotate(0deg);
}

.dark .moon-icon {
  display: flex;
  opacity: 1;
  visibility: visible;
  transform: rotate(360deg);
}

/* 다크 모드에서 라이트 모드로 전환 시 */
.theme-toggle-button.animating.from-dark .sun-icon {
  visibility: visible;
  animation: sun-rise 0.8s ease-in-out forwards;
}

.theme-toggle-button.animating.from-dark .moon-icon {
  visibility: visible;
  animation: moon-set 0.8s ease-in-out forwards;
}

.theme-toggle-button:hover .theme-icon svg {
  transform: scale(1.2);
  transition: transform 0.2s ease, fill 0.3s ease;
}

/* 태양 아이콘 hover 시 주황색 */
.theme-toggle-button:hover .sun-icon svg {
  fill: #FFA500;
}

/* 달 아이콘 hover 시 금색 */
.theme-toggle-button:hover .moon-icon svg {
  fill: #FFD700;
}

@keyframes sun-rise {
  from {
    transform: rotate(180deg);
    opacity: 0;
  }
  to {
    transform: rotate(360deg);
    opacity: 1;
  }
}

@keyframes sun-set {
  from {
    transform: rotate(360deg);
    opacity: 1;
    visibility: visible;
  }
  to {
    transform: rotate(540deg);
    opacity: 0;
    visibility: hidden;
  }
}

@keyframes moon-rise {
  from {
    transform: rotate(180deg);
    opacity: 0;
    visibility: visible;
  }
  to {
    transform: rotate(360deg);
    opacity: 1;
    visibility: visible;
  }
}

@keyframes moon-set {
  from {
    transform: rotate(360deg);
    opacity: 1;
    visibility: visible;
  }
  to {
    transform: rotate(540deg);
    opacity: 0;
    visibility: hidden;
  }
}